---
title: "hgcA scaffolds from assembly"
author: "Benjamin D. Peterson"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

### Length of hgcA scaffolds

First I just wanted to check out the length of the hgcA scaffolds and compare them to the coverage.
I'm particularly interested in this for our binning, since we'll have to set a cutoff for the scaffold in terms of binning length.

```{r hgcA+ scaffold length, echo = FALSE}

hgcA.list <- readLines("/Users/benjaminpeterson/Documents/research/Everglades/dataEdited/2018_analysis_assembly/hgcA/hgcA.txt")
hgcA.list.scaffolds <- paste(strsplit(hgcA.list, "_") %>%
                               sapply("[", 1),
                             strsplit(hgcA.list, "_") %>%
                               sapply("[", 2),
                             sep = "_")

hgcA.scaffolds <- read.csv("/Users/benjaminpeterson/Documents/research/Everglades/dataEdited/2018_analysis_assembly/hgcA/depth/hgcA_coverage.csv",
                           stringsAsFactors = FALSE) %>%
  filter(seqID %in% hgcA.list.scaffolds) %>%
  mutate(coverage = ENP18_001_002_003 + ENP18_024_025 + ENP18_030_032 +
           ENP18_048_049_50 + ENP18_061)

hgcA.scaffolds$max_coverage <- apply(hgcA.scaffolds[, c("ENP18_001_002_003", "ENP18_024_025", "ENP18_030_032", "ENP18_048_049_50", "ENP18_061")], 1, max)

par(mfrow = c(1, 2))
plot(x = hgcA.scaffolds$length,
     y = hgcA.scaffolds$coverage,
     pch = 19,
     ylab = "Total Read Coverage (per 10 million reads)",
     xlab = "Length of scaffold")
plot(x = hgcA.scaffolds$length,
     y = hgcA.scaffolds$max_coverage,
     pch = 19,
     ylab = "Max Read Coverage (per 10 million reads)",
     xlab = "Length of scaffold")
abline(v = 2500, col = "blue")
abline(v = 2000)
abline(v = 1500,
       col = "red")
```


If we use our normal cutoff for binning of 2000bp scaffolds, then we'll include 10 hgcA sequences in the binning.
Only lose 2 if we bump that binning cutoff up to 2500bp (blue line), and would gain 6 if we went down to 1500 (red line).
I think our best bet is to go ahead with the 2000bp cutoff limit for now.
